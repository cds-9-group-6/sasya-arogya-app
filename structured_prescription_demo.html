<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Structured Prescription System - JSON Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
            color: white;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .flow-diagram {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            gap: 20px;
            margin-bottom: 40px;
            align-items: center;
        }

        .flow-step {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .flow-step h3 {
            color: #2E7D32;
            margin-bottom: 10px;
        }

        .flow-arrow {
            font-size: 24px;
            color: #4CAF50;
            text-align: center;
        }

        .json-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .json-section h2 {
            color: #2E7D32;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .json-code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .json-key {
            color: #68d391;
        }

        .json-string {
            color: #fbb6ce;
        }

        .json-number {
            color: #90cdf4;
        }

        .json-boolean {
            color: #f6e05e;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .result-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .result-header {
            background: linear-gradient(135deg, #FF8F00, #FFA726);
            color: white;
            padding: 16px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
        }

        .result-header.standalone {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
        }

        /* Embedded Prescription in Disease Card */
        .disease-card {
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            border: 2px solid #FFA726;
            margin: 20px;
            border-radius: 16px;
            overflow: hidden;
        }

        .disease-header {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .disease-icon {
            width: 48px;
            height: 48px;
            background: #FFA726;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .disease-info h2 {
            font-size: 18px;
            color: #2E2E2E;
            margin-bottom: 2px;
        }

        .disease-badge {
            background: #FF8F00;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        /* Structured Prescription Component */
        .structured-prescription {
            margin: 12px;
        }

        .prescription-header {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
            color: white;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-radius: 8px 8px 0 0;
        }

        .prescription-steps {
            background: #FFE0B2;
            padding: 12px;
        }

        .prescription-step {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid #4CAF50;
        }

        .step-number {
            font-size: 16px;
            min-width: 24px;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-size: 12px;
            font-weight: bold;
            color: #FF8F00;
            margin-bottom: 2px;
        }

        .step-description {
            font-size: 13px;
            color: #2E2E2E;
        }

        /* Standalone Prescription Card */
        .standalone-prescription {
            background: white;
            margin: 20px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .standalone-header {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .patient-info {
            background: #F1F8E9;
            padding: 16px;
        }

        .patient-row {
            display: flex;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .patient-row .label {
            font-weight: bold;
            color: #1B5E20;
            min-width: 100px;
        }

        .patient-row .value {
            color: #2E7D32;
        }

        .treatment-details {
            padding: 20px;
        }

        .treatment-section {
            margin-bottom: 20px;
        }

        .treatment-section h4 {
            color: #1B5E20;
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .treatment-section .content {
            background: #F9F9F9;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #4CAF50;
            font-size: 13px;
            line-height: 1.4;
        }

        .features-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .feature {
            background: #F1F8E9;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
        }

        .feature h3 {
            color: #1B5E20;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature ul {
            margin-left: 20px;
            color: #2E7D32;
        }

        .integration-note {
            background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
            border-left: 4px solid #2196F3;
            padding: 16px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .integration-note h4 {
            color: #1976D2;
            margin-bottom: 8px;
        }

        .code-highlight {
            background: #FFF3E0;
            border: 1px solid #FFB74D;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            color: #E65100;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã Structured Prescription System</h1>
            <p>New JSON Response Integration with Farmer-Friendly Display</p>
        </div>

        <div class="flow-diagram">
            <div class="flow-step">
                <h3>üì° Server Response</h3>
                <p>Structured JSON with comprehensive prescription data</p>
            </div>
            <div class="flow-arrow">‚û°Ô∏è</div>
            <div class="flow-step">
                <h3>üß† App Processing</h3>
                <p>Parse JSON into StructuredPrescription model</p>
            </div>
            <div class="flow-arrow">‚û°Ô∏è</div>
            <div class="flow-step">
                <h3>üë®‚Äçüåæ Farmer Display</h3>
                <p>Embedded or Standalone prescription cards</p>
            </div>
        </div>

        <div class="json-section">
            <h2>üìÑ New Structured JSON Response Example</h2>
            <div class="json-code">{
  <span class="json-key">"diagnosis"</span>: {
    <span class="json-key">"disease_name"</span>: <span class="json-string">"Brown Hopper Blast"</span>,
    <span class="json-key">"symptoms"</span>: [<span class="json-string">"leaves drying"</span>, <span class="json-string">"brown hopper attack"</span>],
    <span class="json-key">"severity"</span>: <span class="json-string">"severe"</span>,
    <span class="json-key">"affected_parts"</span>: [<span class="json-string">"leaves"</span>]
  },

  <span class="json-key">"immediate_treatment"</span>: {
    <span class="json-key">"actions"</span>: [
      <span class="json-string">"Spray a fungicide containing chlorothalonil at 800 ppm as soon as possible."</span>,
      <span class="json-string">"Apply an insecticide containing imidacloprid to control the brown hopper population."</span>
    ],
    <span class="json-key">"emergency_measures"</span>: [<span class="json-string">"Remove weeds and debris around the field"</span>],
    <span class="json-key">"timeline"</span>: <span class="json-string">"immediate"</span>
  },

  <span class="json-key">"medicine_recommendations"</span>: {
    <span class="json-key">"primary_treatment"</span>: {
      <span class="json-key">"medicine_name"</span>: <span class="json-string">"Chlorothalonil"</span>,
      <span class="json-key">"active_ingredient"</span>: <span class="json-string">"Chlorothalonil"</span>,
      <span class="json-key">"dosage"</span>: <span class="json-string">"800 ppm"</span>,
      <span class="json-key">"application_method"</span>: <span class="json-string">"Spray"</span>,
      <span class="json-key">"frequency"</span>: <span class="json-string">"every 7-10 days"</span>,
      <span class="json-key">"duration"</span>: <span class="json-string">"until leaf drying slows down"</span>,
      <span class="json-key">"precautions"</span>: [<span class="json-string">"Wear protective clothing, avoid spraying during peak sun hours"</span>]
    },
    <span class="json-key">"secondary_treatment"</span>: {
      <span class="json-key">"medicine_name"</span>: <span class="json-string">"Imidacloprid"</span>,
      <span class="json-key">"dosage"</span>: <span class="json-string">"0.6-1.2 kg/ha"</span>,
      <span class="json-key">"when_to_use"</span>: <span class="json-string">"When brown hopper population is high"</span>
    }
  },

  <span class="json-key">"prevention"</span>: {
    <span class="json-key">"cultural_practices"</span>: [<span class="json-string">"Maintain good field hygiene"</span>, <span class="json-string">"Remove weeds and debris"</span>],
    <span class="json-key">"environmental_controls"</span>: [<span class="json-string">"Use resistant crop varieties"</span>, <span class="json-string">"Avoid overwatering"</span>],
    <span class="json-key">"monitoring_schedule"</span>: <span class="json-string">"Monitor leaf health, hopper population every 7-10 days"</span>
  },

  <span class="json-key">"additional_notes"</span>: {
    <span class="json-key">"weather_considerations"</span>: <span class="json-string">"Avoid spraying during peak sun hours"</span>,
    <span class="json-key">"regional_considerations"</span>: <span class="json-string">"Consult local agricultural experts for specific advice"</span>
  },

  <span class="json-key">"disease_name"</span>: <span class="json-string">"Brown Hopper Blast"</span>,
  <span class="json-key">"plant_type"</span>: <span class="json-string">"Rice"</span>,
  <span class="json-key">"severity"</span>: <span class="json-string">"severe"</span>
}</div>
        </div>

        <div class="result-grid">
            <!-- Embedded in Disease Card -->
            <div class="result-card">
                <div class="result-header">
                    ü¶† Embedded in Disease Card
                </div>
                
                <div class="disease-card">
                    <div class="disease-header">
                        <div class="disease-icon">üåæ</div>
                        <div class="disease-info">
                            <h2>Brown Hopper Blast</h2>
                            <div style="font-size: 14px; color: #5D4037;">Confidence: 92%</div>
                        </div>
                        <div class="disease-badge">SEVERE</div>
                    </div>

                    <!-- Structured Prescription Component -->
                    <div class="structured-prescription">
                        <div class="prescription-header">
                            <div style="font-size: 24px; font-weight: bold;">‚Ñû</div>
                            <div style="flex: 1; font-size: 14px; font-weight: bold;">TREATMENT PRESCRIPTION</div>
                            <div style="font-size: 11px; opacity: 0.9;">Dec 24</div>
                        </div>
                        
                        <div class="prescription-steps">
                            <div class="prescription-step">
                                <div class="step-number">1Ô∏è‚É£</div>
                                <div class="step-content">
                                    <div class="step-title">IMMEDIATE ACTION</div>
                                    <div class="step-description">Spray fungicide containing chlorothalonil at 800 ppm immediately</div>
                                </div>
                            </div>
                            
                            <div class="prescription-step">
                                <div class="step-number">2Ô∏è‚É£</div>
                                <div class="step-content">
                                    <div class="step-title">APPLY MEDICINE</div>
                                    <div class="step-description">Spray Chlorothalonil at 800 ppm</div>
                                </div>
                            </div>
                            
                            <div class="prescription-step">
                                <div class="step-number">3Ô∏è‚É£</div>
                                <div class="step-content">
                                    <div class="step-title">REPEAT SCHEDULE</div>
                                    <div class="step-description">Every 7-10 days, early morning for best results</div>
                                </div>
                            </div>
                            
                            <div class="prescription-step">
                                <div class="step-number">4Ô∏è‚É£</div>
                                <div class="step-content">
                                    <div class="step-title">MONITOR & CARE</div>
                                    <div class="step-description">Monitor leaf health, hopper population, maintain good field hygiene</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Standalone Prescription Card -->
            <div class="result-card">
                <div class="result-header standalone">
                    ‚Ñû Standalone Prescription Card
                </div>
                
                <div class="standalone-prescription">
                    <div class="standalone-header">
                        <div style="font-size: 32px; font-weight: bold;">‚Ñû</div>
                        <div style="flex: 1;">
                            <div style="font-size: 18px; font-weight: bold; margin-bottom: 2px;">PLANT PRESCRIPTION</div>
                            <div style="font-size: 12px; opacity: 0.8;">AI Plant Health System</div>
                        </div>
                        <div style="font-size: 12px;">Dec 24, 2024</div>
                    </div>

                    <div class="patient-info">
                        <h3 style="font-size: 12px; font-weight: bold; color: #1B5E20; margin-bottom: 8px;">PATIENT INFORMATION</h3>
                        <div class="patient-row">
                            <span class="label">Plant Type:</span>
                            <span class="value">Rice</span>
                        </div>
                        <div class="patient-row">
                            <span class="label">Diagnosis:</span>
                            <span class="value" style="color: #FF8F00;">Brown Hopper Blast</span>
                        </div>
                        <div class="patient-row">
                            <span class="label">Severity:</span>
                            <span class="value" style="color: #F44336;">Severe</span>
                        </div>
                    </div>

                    <div class="treatment-details">
                        <div class="treatment-section">
                            <h4>üíä PRIMARY MEDICATION</h4>
                            <div class="content">
                                <strong>Medicine:</strong> Chlorothalonil<br>
                                <strong>Dosage:</strong> 800 ppm<br>
                                <strong>Application:</strong> Spray<br>
                                <strong>Frequency:</strong> Every 7-10 days<br>
                                <strong>Duration:</strong> Until leaf drying slows down
                            </div>
                        </div>

                        <div class="treatment-section">
                            <h4>üö® IMMEDIATE ACTIONS</h4>
                            <div class="content">
                                1. Spray fungicide containing chlorothalonil at 800 ppm immediately<br>
                                2. Apply insecticide containing imidacloprid to control brown hopper population<br>
                                3. Remove weeds and debris around the field
                            </div>
                        </div>

                        <div class="treatment-section">
                            <h4>‚ö†Ô∏è SAFETY PRECAUTIONS</h4>
                            <div class="content">
                                ‚Ä¢ Wear protective clothing<br>
                                ‚Ä¢ Avoid spraying during peak sun hours<br>
                                ‚Ä¢ Consult local agricultural experts for specific advice
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="features-section">
            <h2>üöÄ Key Integration Features</h2>
            
            <div class="features-grid">
                <div class="feature">
                    <h3>üîÑ Backward Compatibility</h3>
                    <ul>
                        <li><strong>Priority 1:</strong> Use structured JSON when available</li>
                        <li><strong>Priority 2:</strong> Fall back to text parsing</li>
                        <li><strong>Seamless transition:</strong> No disruption to existing functionality</li>
                        <li><strong>Smart detection:</strong> Automatic format recognition</li>
                    </ul>
                </div>

                <div class="feature">
                    <h3>üèóÔ∏è Structured Data Models</h3>
                    <ul>
                        <li><strong>StructuredPrescription:</strong> Main container class</li>
                        <li><strong>Diagnosis:</strong> Disease info with symptoms & severity</li>
                        <li><strong>ImmediateTreatment:</strong> Urgent actions & timeline</li>
                        <li><strong>MedicineRecommendations:</strong> Primary/secondary treatments</li>
                        <li><strong>Prevention:</strong> Cultural practices & monitoring</li>
                    </ul>
                </div>

                <div class="feature">
                    <h3>üë®‚Äçüåæ Farmer-Friendly Processing</h3>
                    <ul>
                        <li><strong>Step-by-step breakdown:</strong> Complex data ‚Üí Simple actions</li>
                        <li><strong>Context-aware display:</strong> Different formats for different needs</li>
                        <li><strong>Smart extraction:</strong> Key info pulled from structured fields</li>
                        <li><strong>Visual consistency:</strong> Same farmer experience across formats</li>
                    </ul>
                </div>

                <div class="feature">
                    <h3>üéØ Smart Card Selection</h3>
                    <ul>
                        <li><strong>Embedded:</strong> When disease detected with structured treatment</li>
                        <li><strong>Standalone:</strong> When prescription explicitly requested</li>
                        <li><strong>Simple treatment:</strong> Falls back to basic text format</li>
                        <li><strong>Flexible logic:</strong> Adapts to content and context</li>
                    </ul>
                </div>
            </div>

            <div class="integration-note">
                <h4>üì° Server Integration Requirements</h4>
                <p>To use the new structured prescription system, your server should include the <span class="code-highlight">structuredPrescription</span> field in the ChatMessage when sending prescription data. The app will automatically detect and use this structured data for enhanced farmer-friendly display.</p>
                
                <p style="margin-top: 10px;"><strong>Example server response processing:</strong></p>
                <div class="code-highlight" style="margin-top: 8px;">
// Parse prescription JSON from server response<br>
val structuredPrescription = Gson().fromJson(prescriptionJson, StructuredPrescription::class.java)<br><br>
// Create ChatMessage with structured data<br>
ChatMessage(<br>
&nbsp;&nbsp;text = assistantResponse,<br>
&nbsp;&nbsp;isUser = false,<br>
&nbsp;&nbsp;structuredPrescription = structuredPrescription<br>
)
                </div>
            </div>
        </div>
    </div>

    <script>
        // Add some interactivity
        document.querySelectorAll('.prescription-step, .treatment-section').forEach(step => {
            step.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.02)';
                this.style.transition = 'all 0.2s ease';
            });
            
            step.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Simulate JSON highlighting
        const jsonCode = document.querySelector('.json-code');
        jsonCode.addEventListener('click', function() {
            this.style.backgroundColor = '#1a202c';
            setTimeout(() => {
                this.style.backgroundColor = '#2d3748';
            }, 200);
        });
    </script>
</body>
</html>

